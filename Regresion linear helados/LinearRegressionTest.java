import java.util.Arrays;
public class LinearRegressionTest {
    public static void main(String[] args) {
        double[][] X_train = {{-4.662262677220208}, {-4.316559446725467}, {-4.213984764590729}, {-3.9496610890515707}, {-3.578553716228682}, {-3.455711698065576}, {-3.1084401208909964}, {-3.0813033243034563}, {-2.672460827006454}, {-2.652286792936049}, {-2.6514980333001315}, {-2.288263998488389}, {-2.111869690297304}, {-1.8189376094349368}, {-1.6603477296372017}, {-1.3263789834948425}, {-1.1731232680778254}, {-0.773330043103446}, {-0.6737528018380356}, {-0.14963486653359837}, {-0.03615649768268739}, {-0.033895285571446534}, {0.00860769873161413}, {0.14924457404675835}, {0.6887809076106148}, {0.6935988725293257}, {0.8749050291584157}, {1.0241808138155706}, {1.2407116187783346}, {1.3598126741393184}, {1.7400000122653544}, {1.850551925836895}, {1.9993103690372853}, {2.075100596577272}, {2.318591239633373}, {2.4719459973351453}, {2.784836463321575}, {2.8317602113138346}, {2.959932091478899}, {3.020874314267157}, {3.211366144342004}, {3.270044068238683}, {3.316072519311853}, {3.3359324122355546}, {3.6107784776680404}, {3.7040574383772156}, {4.130867961260749}, {4.133533788303586}, {4.899031513688672}};
        
        double[] y_train = {-4.662262677220208, -4.316559446725467, -4.213984764590729, -3.9496610890515707, -3.578553716228682, -3.455711698065576, -3.1084401208909964, -3.0813033243034563, -2.672460827006454, -2.652286792936049, -2.6514980333001315, -2.288263998488389, -2.111869690297304, -1.8189376094349368, -1.6603477296372017, -1.3263789834948425, -1.1731232680778254, -0.773330043103446, -0.6737528018380356, -0.14963486653359837, -0.03615649768268739, -0.033895285571446534, 0.00860769873161413, 0.14924457404675835, 0.6887809076106148, 0.6935988725293257, 0.8749050291584157, 1.0241808138155706, 1.2407116187783346, 1.3598126741393184, 1.7400000122653544, 1.850551925836895, 1.9993103690372853, 2.075100596577272, 2.318591239633373, 2.4719459973351453, 2.784836463321575, 2.8317602113138346, 2.959932091478899, 3.020874314267157, 3.211366144342004, 3.270044068238683, 3.316072519311853, 3.3359324122355546, 3.6107784776680404, 3.7040574383772156, 4.130867961260749, 4.133533788303586, 4.899031513688672};
        
        double[][] X_test = {
            {5},
            {4},
            {3}
        };
        
        double[] y_test = {
            4,
            3,
            2
        };
        
        System.out.println("Linear Regression without Scaling");
        LinearRegression lr1 = new LinearRegression(true);
        lr1.fit(X_train, y_train, 5000, 0.01);
        
        System.out.println("Weights: " + Arrays.toString(lr1.getWeights()));
        System.out.println("Bias: " + lr1.getBias());
        
        double[] y_hat1 = lr1.predict(X_test);
        for (int i = 0; i < y_hat1.length; i++) {
            System.out.printf("Predicted: %.2f, Actual: %.2f%n", y_hat1[i], y_test[i]);
        }
        
        System.out.printf("R² Score: %.4f%n", lr1.score(X_test, y_test));
        System.out.printf("MSE: %.2f%n", lr1.scoreMSE(X_test, y_test));
        System.out.printf("MAE: %.2f%n", lr1.scoreMAE(X_test, y_test));
        
        System.out.println("\n=== Linear Regression with Scaling ===");
        LinearRegression lr2 = new LinearRegression(true);
        lr2.fit(X_train, y_train, 5000, 0.01);
        
        System.out.println("Weights: " + Arrays.toString(lr2.getWeights()));
        System.out.println("Bias: " + lr2.getBias());
        
        double[] y_hat2 = lr2.predict(X_test);
        for (int i = 0; i < y_hat2.length; i++) {
            System.out.printf("Predicted: %.2f, Actual: %.2f%n", y_hat2[i], y_test[i]);
        }
        
        System.out.printf("R² Score: %.4f%n", lr2.score(X_test, y_test));
        System.out.printf("MSE: %.2f%n", lr2.scoreMSE(X_test, y_test));
        System.out.printf("MAE: %.2f%n", lr2.scoreMAE(X_test, y_test));
    }
}